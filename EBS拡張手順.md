# EBSボリューム拡張後の手順

## ステップ1: ファイルシステムを拡張

EBSボリュームのサイズを増やした後、ファイルシステムを拡張する必要があります。

### 自動拡張スクリプトを使用（推奨）

```bash
chmod +x expand-filesystem.sh
./expand-filesystem.sh
```

### 手動で拡張する場合

#### 1. パーティション情報を確認

```bash
lsblk
df -h
```

#### 2. growpartをインストール（必要な場合）

```bash
sudo apt-get update
sudo apt-get install -y cloud-guest-utils
```

#### 3. パーティションを拡張

**NVMeデバイスの場合（例: /dev/nvme0n1p1）:**
```bash
sudo growpart /dev/nvme0n1 1
```

**従来のデバイスの場合（例: /dev/xvda1）:**
```bash
sudo growpart /dev/xvda 1
```

#### 4. ファイルシステムを拡張

**ext4/ext3/ext2の場合:**
```bash
sudo resize2fs /dev/nvme0n1p1  # デバイス名は環境により異なります
```

**xfsの場合:**
```bash
sudo xfs_growfs /
```

#### 5. 確認

```bash
df -h
```

## トラブルシューティング

### パーティションが拡張されない場合

1. ボリュームサイズが実際に増えているか確認:
   ```bash
   lsblk
   ```

2. インスタンスを再起動してから再度試す

3. AWSコンソールでボリュームの変更が完了しているか確認

### ファイルシステムが拡張されない場合

1. パーティションが正しく拡張されているか確認:
   ```bash
   sudo fdisk -l
   ```

2. ファイルシステムのタイプを確認:
   ```bash
   df -T /
   ```

3. エラーメッセージを確認して対処

## 注意事項

- ファイルシステムの拡張は通常、データを失うことなく実行できます
- 念のため、重要なデータはバックアップを取ることを推奨します
- 拡張中は他の操作を避けてください

## 拡張後の確認

拡張が成功したら、以下のコマンドで確認できます:

```bash
df -h
```

使用率が100%から下がっていれば成功です。
